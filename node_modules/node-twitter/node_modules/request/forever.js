function e(t){var s=this;s.options=t||{},s.requests={},s.sockets={},s.freeSockets={},s.maxSockets=s.options.maxSockets||o.defaultMaxSockets,s.minSockets=s.options.minSockets||e.defaultMinSockets,s.on("free",function(e,t,o){var r=t+":"+o;if(s.requests[r]&&s.requests[r].length)s.requests[r].shift().onSocket(e);else if(s.sockets[r].length<s.minSockets){s.freeSockets[r]||(s.freeSockets[r]=[]),s.freeSockets[r].push(e);function i(){e.destroy()}e._onIdleError=i,e.on("error",i)}else e.destroy()})}function t(t){e.call(this,t)}module.exports=e,e.SSL=t;var s=require("util"),o=require("http").Agent,r=require("net"),i=require("tls"),n=require("https").Agent;s.inherits(e,o),e.defaultMinSockets=5,e.prototype.createConnection=r.createConnection,e.prototype.addRequestNoreuse=o.prototype.addRequest,e.prototype.addRequest=function(e,t,s){var o,r=t+":"+s;this.freeSockets[r]&&this.freeSockets[r].length>0&&!e.useChunkedEncodingByDefault?((o=this.freeSockets[r].pop()).removeListener("error",o._onIdleError),delete o._onIdleError,e._reusedSocket=!0,e.onSocket(o)):this.addRequestNoreuse(e,t,s)},e.prototype.removeSocket=function(e,t,s,o){var r;this.sockets[t]?-1!==(r=this.sockets[t].indexOf(e))&&this.sockets[t].splice(r,1):this.sockets[t]&&0===this.sockets[t].length&&(delete this.sockets[t],delete this.requests[t]),this.freeSockets[t]&&-1!==(r=this.freeSockets[t].indexOf(e))&&(this.freeSockets[t].splice(r,1),0===this.freeSockets[t].length&&delete this.freeSockets[t]),this.requests[t]&&this.requests[t].length&&this.createSocket(t,s,o).emit("free")},s.inherits(t,e),t.prototype.createConnection=function(e,t,s){return s.port=e,s.host=t,i.connect(s)},t.prototype.addRequestNoreuse=n.prototype.addRequest;